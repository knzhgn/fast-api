# FastAPI: Регистрация, Логин с Хешированием Паролей и JWT-Аутентификацией

API на основе **FastAPI** для регистрации и аутентификации пользователей с использованием хеширования паролей и выдачи **JWT-токенов** для последующей авторизации.

## Описание

Этот проект представляет собой учебный пример реализации REST API с **FastAPI**, включающий регистрацию пользователей, безопасное хранение паролей и аутентификацию с помощью **JWT-токенов**. Проект демонстрирует интеграцию современных технологий для создания безопасного и масштабируемого API.

## Технологии

- **Python 3.10+**
- **FastAPI**
- **Uvicorn** (ASGI-сервер)
- **PostgreSQL**
- **SQLModel** / **SQLAlchemy** (ORM)
- **Passlib** (схема **bcrypt** для хеширования паролей)
- **python-jose** (с поддержкой **cryptography** для работы с JWT)
- **asyncpg** (асинхронный драйвер для PostgreSQL)

## Установка и запуск

1. **Клонирование или создание проекта**:  
   Клонируйте репозиторий или создайте новую папку для проекта.

2. **Создание и активация виртуального окружения**:  
   - Создайте окружение:
     ```bash
     python -m venv .venv
     ```
   - Активируйте окружение:
     - Для Linux/macOS:
       ```bash
       source .venv/bin/activate
       ```
     - Для Windows:
       ```bash
       .venv\Scripts\activate
       ```

3. **Установка зависимостей**:  
   Установите необходимые пакеты:
   ```bash
   pip install fastapi uvicorn sqlmodel asyncpg psycopg2-binary passlib[bcrypt] "python-jose[cryptography]"
   ```

4. **Настройка подключения к базе данных**:  
   В файле `main.py` обновите строку подключения, указав свои данные:
   ```python
   DATABASE_URL = "postgresql+asyncpg://username:password@localhost:5432/notesdb"
   ```
   Замените `username`, `password` и имя базы данных (`notesdb`) на свои.

5. **Запуск сервера**:  
   Запустите сервер:
   ```bash
   uvicorn main:app --reload
   ```

6. **Доступ к документации**:  
   - **Swagger UI**: [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)
   - **ReDoc**: [http://127.0.0.1:8000/redoc](http://127.0.0.1:8000/redoc)

## Эндпоинты API

### POST /register
- **Описание**: Регистрация нового пользователя.
- **Тело запроса** (JSON):
  ```json
  {
    "username": "string",
    "password": "string"
  }
  ```
- **Особенности**: Пароль автоматически хешируется с использованием **bcrypt**.
- **Ответ** (JSON):
  ```json
  {
    "id": 1,
    "username": "string"
  }
  ```

### POST /login
- **Описание**: Аутентификация пользователя.
- **Тело запроса** (JSON):
  ```json
  {
    "username": "string",
    "password": "string"
  }
  ```
- **Ответ** (JSON) при успехе:
  ```json
  {
    "access_token": "jwt_token_string",
    "token_type": "bearer"
  }
  ```
- **Ошибки**: `401 Unauthorized` — при неверных данных пользователя или пароле.

## Особенности

- **Хеширование паролей**: Пароли хранятся в базе данных в виде **bcrypt**-хешей, что обеспечивает безопасность.
- **JWT-токены**: Токены подписываются секретным ключом и имеют ограниченное время жизни (по умолчанию — 30 минут).
- **Масштабируемость**: Возможность расширения для защиты других эндпоинтов с помощью проверки JWT-токенов.

## Тестирование

- **Рекомендации**: Используйте **Swagger UI**, **ReDoc** или **Postman** для тестирования.
- **Проверяйте**:
  - Регистрацию нового пользователя.
  - Аутентификацию и получение JWT-токена.
  - Валидность токена на сайте [jwt.io](https://jwt.io) (вставьте токен в поле *Encoded*).

## Безопасность

- **Секретный ключ**: Храните `SECRET_KEY` в безопасном месте, например, в переменных окружения.
- **Рекомендации**: Реализуйте защиту дополнительных эндпоинтов, проверку токенов и механизм логаута для повышения безопасности.

## Контакты

Если вам нужна помощь с развитием проекта или есть вопросы, пишите мне в **Microsoft Teams**.